import{getCookie as l}from"./utils.min.js";const o=Object.freeze({editPost:e=>`/post/${e}`,followUser:e=>`/follow/${e}`,likePost:e=>`/post/${e}`,deletePost:e=>`/post/${e}`,fetchProfile:e=>`/profile/${e}`,getUserEmail:e=>`/user/${e}/email`,createComment:e=>`/post/${e}/comment`,fetchComments:e=>`/post/${e}/comments`,editComment:e=>`/post/comment/${e}`,deleteComment:e=>`/post/comment/${e}`,editProfile:()=>"/profile/edit",register:()=>"/register",login:()=>"/login",createPost:"/post",logout:()=>"/logout"});async function t(e,s="GET",r=null){const n={method:s,headers:{}};["POST","PUT","DELETE"].includes(s.toUpperCase())&&(n.headers["X-CSRFToken"]=l("csrftoken")),r&&(r instanceof FormData?n.body=r:(n.headers["Content-Type"]="application/json",n.body=JSON.stringify(r)));const i=await fetch(e,n),c=await i.json().catch(()=>({}));if(!i.ok){const a=c.error||`HTTP Error status: ${i.status}`;throw new Error(a)}return c}export const API={editComment:async(e,s)=>t(o.editComment(e),"PUT",{action:"edit",content:s}),deleteComment:async e=>t(o.deleteComment(e),"DELETE",{action:"delete"}),editPost:async(e,s)=>t(o.editPost(e),"PUT",{action:"edit",content:s}),likePost:async e=>t(o.likePost(e),"PUT",{action:"like"}),createPost:async e=>t(o.createPost,"POST",{content:e}),editProfile:async e=>t(o.editProfile(),"POST",e),register:async e=>t(o.register(),"POST",e),login:async e=>t(o.login(),"POST",e),fetchProfile:async e=>t(o.fetchProfile(e)),fetchComments:async e=>t(o.fetchComments(e)),createComment:async(e,s)=>t(o.createComment(e),"POST",{content:s}),followUser:async e=>t(o.followUser(e),"PUT"),deletePost:async e=>t(o.deletePost(e),"DELETE",{action:"delete"}),getUserEmail:async e=>t(o.getUserEmail(e)),logout:async()=>t(o.logout()),fetchPosts:async e=>t(e),getMorePosts:async e=>t(e)};